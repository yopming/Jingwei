{% extends "sources/building/navigation.html" %}

{% block title %} 建筑－分享 {% endblock %}

{% block is_active_building_share %} active {% endblock %}

{% block real %}
<section id="doc-share" class="section">
    <div class="header">
        <h2>分享<small>less/share</small></h2>
    </div>
    <div class="content">
        <h3>单行</h3>
        <div class="rule-code">
            <div class="rule-code-title">Example</div>
            <div class="rule-code-content">
                <pre class="prettyprint linenums typo-orig">
&lt;div class="share share-line"&gt;
    &lt;span class="name"&gt;分享到：&lt;/span&gt;
    &lt;input type="hidden" value="foo" id="dev_title"&gt;
    &lt;input type="hidden" value="foo" id="dev_isnotsina_title"&gt;
    &lt;input type="hidden" value="foo" id="recommendUrl"&gt;

    &lt;span class="shareSNS"&gt;
        &lt;a href="javascript:void(0)" sharetype="1" rel="nofollow" 
        title="新浪微博分享" class="dev_share_flag sina" 
        data="http://service.weibo.com/share/share.php"&gt;
            新浪微博
        &lt;/a&gt;
        &lt;a href="javascript:void(0)" sharetype="2" rel="nofollow" 
        title="邮件分享" class="dev_share_email_cj email"&gt;
            邮件分享
        &lt;/a&gt;
        &lt;a class="shareAll" href="javascript:void(0);"&gt;
            &lt;span&gt;更多&lt;/span&gt;
        &lt;/a&gt;
    &lt;/span&gt;
    &lt;div style="visibility: visible;" id="sharebox"&gt;&lt;/div&gt;
&lt;/div&gt;</pre>
            </div>
            <div class="rule-code-example">
                <div class="share share-line">
                    <span class="name">分享到：</span>
                    <span class="shareSNS">
                        <a href="#" title="新浪微博分享" class="sina">新浪微博</a>
                        <a href="#" title="邮件分享" class="email">邮件分享</a>
                        <a class="shareAll" href="#"><span>更多</span></a>
                    </span>
                </div>
            </div>
        </div>

        <h3>弹出</h3>
        <div class="desc">j将分享的Javscript脚本文件引入，然后在页面上使用<code>$('.class').shareSNS()</code>调用插件来实现，具体的引用class根据页面可能不同，具体的function的参数请参照脚本文件来填写。</div>
        <div class="rule-code">
            <div class="rule-code-title">Example</div>
            <div class="rule-code-content">
                <pre class="prettyprint linenums typo-orig">
&lt;div class="share"&gt;
    &lt;input type="hidden" value="foo" id="dev_title"&gt;
    &lt;input type="hidden" value="foo" id="dev_isnotsina_title"&gt;
    &lt;input type="hidden" value="foo" id="recommendUrl"&gt;
    &lt;span class="shareSNS"&gt;&lt;/span&gt;
&lt;/div&gt;</pre>
            </div>
            <div class="rule-code-example">
                <div class="share">
                    <span class="shareSNS shareSNSed"></span>
                </div>
            </div>
            <div class="rule-code-example">
                <div class="share">
                    <div id="sharebox" style="position:static;">
                        <div id="ats_inner">
                            <div id="ats_head" class="fn-clear">
                                <span class="fl">分享</span>
                                <a class="link-green" target="_blank" href="http://www.xyz.cn/help/detail-110113.html">分享规则  &gt;</a>
                            </div>
                            <div id="at_hover">
                                <a href="javascript:void(0)" sharetype="1" rel="nofollow" title="新浪微博分享" class="dev_share_flag sina" data="http://service.weibo.com/share/share.php">新浪微博</a>
                                <a href="javascript:void(0)" sharetype="2" rel="nofollow" title="邮件分享" class="dev_share_email_cj email" data="http://www.xzy.cn/prodshare.do?xcase=shareEmail">邮件分享</a>
                                <a href="javascript:void(0)" sharetype="3" rel="nofollow" title="腾讯微博分享" class="dev_share_flag tengxunweibo" data="http://v.t.qq.com/share/share.php">腾讯微博</a>
                                <a href="javascript:void(0)" sharetype="4" rel="nofollow" title="淘江湖分享" class="dev_share_flag taobao" data="http://share.jianghu.taobao.com/share/addShare.htm">淘江湖</a>
                                <a href="javascript:void(0)" sharetype="5" rel="nofollow" title="QQ空间分享" class="dev_share_flag qqzone" data="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey">QQ空间</a>
                                <a href="javascript:void(0)" sharetype="6" rel="nofollow" title="人人网分享" class="dev_share_flag renren" data="http://share.renren.com/share/buttonshare.do">人人网</a>
                                <a href="javascript:void(0)" sharetype="7" rel="nofollow" title="百度搜藏分享" class="dev_share_flag baiducang" data="http://cang.baidu.com/do/add">百度搜藏</a>
                                <a href="javascript:void(0)" sharetype="8" rel="nofollow" title="豆瓣网分享" class="dev_share_flag douban" data="https://www.douban.com/accounts/login">豆瓣网</a>
                                <a href="javascript:void(0)" sharetype="9" rel="nofollow" title="开心网分享" class="dev_share_flag kaixin" data="http://www.kaixin001.com/login/open_login.php?flag=1">开心网</a>
                                <a href="javascript:void(0)" sharetype="10" rel="nofollow" title="网易微博分享" class="dev_share_flag wangyi" data="http://t.163.com/article/user/checkLogin.do">网易微博</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>

// share
(function($) {
    var link = [{name: "新浪微博",sharetype: 1,icon: "sina",tip: "新浪微博分享",url: "http://service.weibo.com/share/share.php"}, {name: "邮件分享",sharetype: 2,icon: "email",tip: "邮件分享",url: "http://www.xzy.cn/prodshare.do?xcase=shareEmail"}, {name: "腾讯微博",sharetype: 3,icon: "tengxunweibo",tip: "腾讯微博分享",url: "http://v.t.qq.com/share/share.php"}, {name: "淘江湖",sharetype: 4,icon: "taobao",tip: "淘江湖分享",url: "http://share.jianghu.taobao.com/share/addShare.htm"}, {name: "QQ空间",sharetype: 5,icon: "qqzone",tip: "QQ空间分享",url: "http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey"}, {name: "人人网",sharetype: 6,icon: "renren",tip: "人人网分享",url: "http://share.renren.com/share/buttonshare.do"}, {name: "百度搜藏",sharetype: 7,icon: "baiducang",tip: "百度搜藏分享",url: "http://cang.baidu.com/do/add"}, {name: "豆瓣网",sharetype: 8,icon: "douban",tip: "豆瓣网分享",url: "https://www.douban.com/accounts/login"}, {name: "开心网",sharetype: 9,icon: "kaixin",tip: "开心网分享",url: "http://www.kaixin001.com/login/open_login.php?flag=1"}, {name: "网易微博",sharetype: 10,icon: "wangyi",tip: "网易微博分享",url: "http://t.163.com/article/user/checkLogin.do"}];
    var shareSNS = function(config) {
        var me = this;
        this._init = function() {
            me.threshold = config.threshold || 200;
            config.shortLink = config.shortLink < link.length ? config.shortLink : 4;
            var title = "高洁";
            var url = encodeURIComponent(location);
            config.obj.parent().append(me.shareBox = $('<div style="visibility: hidden;" id="sharebox"><div id="ats_inner"><div id="ats_head" class="fn-clear"><span class="fl">分享</span> <a class="link-green" target="_blank" href="http://www.xyz.cn/help/detail-110113.html">分享规则  &gt;</a></div><div id="at_hover"></div></div></div>'));
            this.itemBox = this.shareBox.find("#at_hover:first");
            var count = 0;
            $(link).each(function(index, item) {
                if (count < config.shortLink) {
                    if (item.sharetype == "2") {
                        config.obj.append('<a href="javascript:void(0)" sharetype=' + item.sharetype + ' rel="nofollow" title="' + (item.tip) + '" class="dev_share_email_cj ' + item.icon + '">' + item.name + "</a>")
                    } else {
                        config.obj.append('<a href="javascript:void(0)" sharetype=' + item.sharetype + ' rel="nofollow" title="' + (item.tip) + '" class="dev_share_flag ' + item.icon + '" data="' + item.url + '">' + item.name + "</a>")
                    }
                    count++
                }
                if (item.sharetype == "2") {
                    me.itemBox.append('<a href="javascript:void(0)" sharetype=' + item.sharetype + ' rel="nofollow" title="' + (item.tip) + '" class="dev_share_email_cj ' + item.icon + '" data="' + item.url + '">' + item.name + "</a>")
                } else {
                    me.itemBox.append('<a href="javascript:void(0)" sharetype=' + item.sharetype + ' rel="nofollow" title="' + (item.tip) + '" class="dev_share_flag ' + item.icon + '" data="' + item.url + '">' + item.name + "</a>")
                }
            });
            config.obj.append('<a class="shareAll" href="javascript:void(0);"><span>更多</span></a>');
            this.shareBox.find("#atsptx:first").click(function() {
                me._hide()
            })
        };
        this.show = function() {
            if (this.shareBox) {
                if (this.timer) {
                    clearTimeout(this.timer)
                }
                var curObjOffset = config.obj.offset();
                var itemHeight = this.itemBox.outerHeight(true);
                var visualHeight = document.documentElement.clientHeight;
                var curObjVisualTop = parseInt(curObjOffset.top) - parseInt(jQuery(document).scrollTop());
                var top = (visualHeight - curObjVisualTop) > 30 + config.obj.height() + itemHeight ? curObjOffset.top + config.obj.height() : curObjOffset.top - itemHeight - config.obj.height() - 25;
                this.shareBox.css("visibility", "visible");
                this.shareBox.unbind().hover(function() {
                    me.show()
                }, function() {
                    me.lazyHide()
                })
            } else {
                this._init()
            }
        };
        this._hide = function() {
            this.shareBox.css("visibility", "hidden")
        };
        this.lazyHide = function() {
            this.timer = setTimeout(function() {
                me._hide()
            }, this.threshold)
        };
        this._init()
    };
    $.fn.shareSNS = function(config) {
        return this.each(function() {
            config = jQuery.extend({obj: $(this),container: $("body"),shortLink: 4,threshold: 200}, config);
            var shareSNSPlugin = new shareSNS(config);
            $(this).find(".shareAll:first").hover(function() {
                shareSNSPlugin.show()
            }, function() {
                shareSNSPlugin.lazyHide()
            })
        })
    }
})(jQuery);

$(".shareSNSed").shareSNS();

</script>
{% endblock %}
